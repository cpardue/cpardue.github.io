---
layout:     post
title:      TheCyberMentor PEH Course Scanning/Enumeration Notes
date:       2021-03-04
summary:    TheCyberMentor Practical Ethical Hacker Course, Scanning and Enumeration notes
categories: certs
thumbnail: cogs
tags:
 - certs
---
<p class="has-line-data" data-line-start="0" data-line-end="1">&lt;body&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-1’&gt;Scanning/Enumeration&lt;/h1&gt;&lt;br/&gt;&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Kioptrix&lt;/h1&gt;&lt;br/&gt;&lt;a href=&quot;<a href="https://www.vulnhub.com/entry/kioptrix-level-1-1,22/">https://www.vulnhub.com/entry/kioptrix-level-1-1,22/</a>“&gt;<a href="https://www.vulnhub.com/entry/kioptrix-level-1-1,22/">https://www.vulnhub.com/entry/kioptrix-level-1-1,22/</a>&lt;/a&gt;  &lt;br /&gt;it’s a vulnhub box, level 1  &lt;br /&gt;&lt;br /&gt;&lt;a href=”<a href="https://www.abatchy.com/2017/02/oscp-like-vulnhub-vms">https://www.abatchy.com/2017/02/oscp-like-vulnhub-vms</a>“&gt;<a href="https://www.abatchy.com/2017/02/oscp-like-vulnhub-vms">https://www.abatchy.com/2017/02/oscp-like-vulnhub-vms</a>&lt;/a&gt;  &lt;br /&gt;oscp-like vulnhub boxes  &lt;br /&gt;&lt;br /&gt;&lt;a href=”<a href="https://www.vmware.com/uk/products/workstation-player/workstation-player-evaluation.html">https://www.vmware.com/uk/products/workstation-player/workstation-player-evaluation.html</a>“&gt;<a href="https://www.vmware.com/uk/products/workstation-player/workstation-player-evaluation.html">https://www.vmware.com/uk/products/workstation-player/workstation-player-evaluation.html</a>&lt;/a&gt;  &lt;br /&gt;to download vmware workstation free  &lt;br /&gt;&lt;br /&gt;&lt;a href=”<a href="https://www.linuxlookup.com/howto/install_vmware_workstation_or_vmware_player_bundle_file">https://www.linuxlookup.com/howto/install_vmware_workstation_or_vmware_player_bundle_file</a>“&gt;<a href="https://www.linuxlookup.com/howto/install_vmware_workstation_or_vmware_player_bundle_file">https://www.linuxlookup.com/howto/install_vmware_workstation_or_vmware_player_bundle_file</a>&lt;/a&gt;  &lt;br /&gt;instructions for installing a vmware .bundle file  &lt;br /&gt;&lt;br /&gt;1. Download Kioptrix lvl 1  &lt;br /&gt;2. Download and install vmware  &lt;br /&gt;3. Unrar kioptrix lvl 1  &lt;br /&gt;4. import into vmware, edit settings, boot  &lt;br /&gt;&lt;br /&gt;currently 192.168.0.71 &lt;br /&gt;arp scan   &lt;br /&gt;sudo arp-scan -l  &lt;br /&gt;&lt;br /&gt;netdiscover  &lt;br /&gt;sudo netdiscover -r 192.168.0.0/24  &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Nmap&lt;/h1&gt;&lt;br/&gt;## scanning with nmap  &lt;br /&gt;losers call it “network mapper”  &lt;br /&gt;stealth scanning (-sS) is by default  &lt;br /&gt;it used to be stealthy, but any IDS will pick it up  &lt;br /&gt;it’s trying to make a connection via SYN -&gt;, then loljk RST -&gt;  &lt;br /&gt;&lt;br /&gt;sudo nmap -p- -A  &lt;br /&gt;scans all ports (-p-) with aggressive scan (-A) but you already know this  &lt;br /&gt;&lt;br /&gt;## let’s do some diff’s  &lt;br /&gt;### nmap 192.168.0.71  &lt;br /&gt;output:  &lt;br /&gt;Not shown: 994 closed ports&lt;br /&gt;PORT     STATE SERVICE&lt;br /&gt;22/tcp   open  ssh&lt;br /&gt;80/tcp   open  http&lt;br /&gt;111/tcp  open  rpcbind&lt;br /&gt;139/tcp  open  netbios-ssn&lt;br /&gt;443/tcp  open  https&lt;br /&gt;1024/tcp open  kdm&lt;br /&gt;&lt;br /&gt;### nmap -p- 192.168.0.71  &lt;br /&gt;output:  &lt;br /&gt;Not shown: 65529 closed ports&lt;br /&gt;PORT     STATE SERVICE&lt;br /&gt;22/tcp   open  ssh&lt;br /&gt;80/tcp   open  http&lt;br /&gt;111/tcp  open  rpcbind&lt;br /&gt;139/tcp  open  netbios-ssn&lt;br /&gt;443/tcp  open  https&lt;br /&gt;1024/tcp open  kdm&lt;br /&gt;&lt;br /&gt;### nmap -sV 192.168.0.71  &lt;br /&gt;output:  &lt;br /&gt;Not shown: 994 closed ports&lt;br /&gt;PORT     STATE SERVICE     VERSION&lt;br /&gt;22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)&lt;br /&gt;80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)&lt;br /&gt;111/tcp  open  rpcbind     2 (RPC #100000)&lt;br /&gt;139/tcp  open  netbios-ssn Samba smbd (workgroup: MYGROUP)&lt;br /&gt;443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b&lt;br /&gt;1024/tcp open  status      1 (RPC #100024)&lt;br /&gt;&lt;br /&gt;### nmap -A 192.168.0.71  &lt;br /&gt;output: &lt;br /&gt;Not shown: 994 closed ports&lt;br /&gt;PORT     STATE SERVICE     VERSION&lt;br /&gt;22/tcp   open  ssh         OpenSSH 2.9p2 (protocol 1.99)&lt;br /&gt;| ssh-hostkey: &lt;br /&gt;|   1024 b8:74:6c:db:fd:8b:e6:66:e9:2a:2b:df:5e:6f:64:86 (RSA1)&lt;br /&gt;|   1024 8f:8e:5b:81:ed:21:ab:c1:80:e1:57:a3:3c:85:c4:71 (DSA)&lt;br /&gt;|_  1024 ed:4e:a9:4a:06:14:ff:15:14:ce:da:3a:80:db:e2:81 (RSA)&lt;br /&gt;|<em>sshv1: Server supports SSHv1&lt;br /&gt;80/tcp   open  http        Apache httpd 1.3.20 ((Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b)&lt;br /&gt;| http-methods: &lt;br /&gt;|</em>  Potentially risky methods: TRACE&lt;br /&gt;|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b&lt;br /&gt;|<em>http-title: Test Page for the Apache Web Server on Red Hat Linux&lt;br /&gt;111/tcp  open  rpcbind     2 (RPC #100000)&lt;br /&gt;| rpcinfo: &lt;br /&gt;|   program version    port/proto  service&lt;br /&gt;|   100000  2            111/tcp   rpcbind&lt;br /&gt;|   100000  2            111/udp   rpcbind&lt;br /&gt;|   100024  1           1024/tcp   status&lt;br /&gt;|</em>  100024  1           1024/udp   status&lt;br /&gt;139/tcp  open  netbios-ssn Samba smbd (workgroup: yMYGROUP)&lt;br /&gt;443/tcp  open  ssl/https   Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b&lt;br /&gt;|_http-server-header: Apache/1.3.20 (Unix)  (Red-Hat/Linux) mod_ssl/2.8.4 OpenSSL/0.9.6b&lt;br /&gt;|_http-title: 400 Bad Request&lt;br /&gt;| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=–&lt;br /&gt;| Not valid before: 2009-09-26T09:32:06&lt;br /&gt;|_Not valid after:  2010-09-26T09:32:06&lt;br /&gt;|<em>ssl-date: 2021-02-03T04:56:14+00:00; +1h01m49s from scanner time.&lt;br /&gt;| sslv2: &lt;br /&gt;|   SSLv2 supported&lt;br /&gt;|   ciphers: &lt;br /&gt;|     SSL2_RC4_128_EXPORT40_WITH_MD5&lt;br /&gt;|     SSL2_RC4_64_WITH_MD5&lt;br /&gt;|     SSL2_RC4_128_WITH_MD5&lt;br /&gt;|     SSL2_DES_192_EDE3_CBC_WITH_MD5&lt;br /&gt;|     SSL2_RC2_128_CBC_WITH_MD5&lt;br /&gt;|     SSL2_DES_64_CBC_WITH_MD5&lt;br /&gt;|</em>    SSL2_RC2_128_CBC_EXPORT40_WITH_MD5&lt;br /&gt;1024/tcp open  status      1 (RPC #100024)&lt;br /&gt;&lt;br /&gt;Host script results:&lt;br /&gt;|_clock-skew: 1h01m48s&lt;br /&gt;|_nbstat: NetBIOS name: KIOPTRIX, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)&lt;br /&gt;|_smb2-time: Protocol negotiation failed (SMB2)  &lt;br /&gt;&lt;br /&gt;### nmap --script=vuln 192.168.0.71  &lt;br /&gt;output: &lt;br /&gt;Not shown: 994 closed ports&lt;br /&gt;PORT     STATE SERVICE&lt;br /&gt;22/tcp   open  ssh&lt;br /&gt;80/tcp   open  http&lt;br /&gt;|_http-csrf: Couldn’t find any CSRF vulnerabilities.&lt;br /&gt;|<em>http-dombased-xss: Couldn’t find any DOM based XSS.&lt;br /&gt;| http-enum: &lt;br /&gt;|   /test.php: Test page&lt;br /&gt;|   /icons/: Potentially interesting directory w/ listing on ‘apache/1.3.20’&lt;br /&gt;|   /manual/: Potentially interesting directory w/ listing on ‘apache/1.3.20’&lt;br /&gt;|</em>  /usage/: Potentially interesting folder&lt;br /&gt;|_http-stored-xss: Couldn’t find any stored XSS vulnerabilities.&lt;br /&gt;|_http-trace: TRACE is enabled&lt;br /&gt;111/tcp  open  rpcbind&lt;br /&gt;139/tcp  open  netbios-ssn&lt;br /&gt;443/tcp  open  https&lt;br /&gt;|_http-aspnet-debug: ERROR: Script execution failed (use -d to debug)&lt;br /&gt;|<em>http-csrf: Couldn’t find any CSRF vulnerabilities.&lt;br /&gt;|<em>http-dombased-xss: Couldn’t find any DOM based XSS.&lt;br /&gt;|<em>http-stored-xss: Couldn’t find any stored XSS vulnerabilities.&lt;br /&gt;| ssl-ccs-injection: &lt;br /&gt;|   VULNERABLE:&lt;br /&gt;|   SSL/TLS MITM vulnerability (CCS Injection)&lt;br /&gt;|     State: VULNERABLE&lt;br /&gt;|     Risk factor: High&lt;br /&gt;|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h&lt;br /&gt;|       does not properly restrict processing of ChangeCipherSpec messages,&lt;br /&gt;|       which allows man-in-the-middle attackers to trigger use of a zero&lt;br /&gt;|       length master key in certain OpenSSL-to-OpenSSL communications, and&lt;br /&gt;|       consequently hijack sessions or obtain sensitive information, via&lt;br /&gt;|       a crafted TLS handshake, aka the “CCS Injection” vulnerability.&lt;br /&gt;|           &lt;br /&gt;|     References:&lt;br /&gt;|       &lt;a href=&quot;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</a>“&gt;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</a>&lt;/a&gt;&lt;br /&gt;|       &lt;a href=”<a href="http://www.cvedetails.com/cve/2014-0224">http://www.cvedetails.com/cve/2014-0224</a>&quot;&gt;<a href="http://www.cvedetails.com/cve/2014-0224">http://www.cvedetails.com/cve/2014-0224</a>&lt;/a&gt;&lt;br /&gt;|</em>      &lt;a href=&quot;<a href="http://www.openssl.org/news/secadv_20140605.txt">http://www.openssl.org/news/secadv_20140605.txt</a>“&gt;<a href="http://www.openssl.org/news/secadv_20140605.txt">http://www.openssl.org/news/secadv_20140605.txt</a>&lt;/a&gt;&lt;br /&gt;| ssl-dh-params: &lt;br /&gt;|   VULNERABLE:&lt;br /&gt;|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)&lt;br /&gt;|     State: VULNERABLE&lt;br /&gt;|     IDs:  BID:74733  CVE:CVE-2015-4000&lt;br /&gt;|       The Transport Layer Security (TLS) protocol contains a flaw that is&lt;br /&gt;|       triggered when handling Diffie-Hellman key exchanges defined with&lt;br /&gt;|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker&lt;br /&gt;|       to downgrade the security of a TLS session to 512-bit export-grade&lt;br /&gt;|       cryptography, which is significantly weaker, allowing the attacker&lt;br /&gt;|       to more easily break the encryption and monitor or tamper with&lt;br /&gt;|       the encrypted stream.&lt;br /&gt;|     Disclosure date: 2015-5-19&lt;br /&gt;|     Check results:&lt;br /&gt;|       EXPORT-GRADE DH GROUP 1&lt;br /&gt;|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA&lt;br /&gt;|             Modulus Type: Safe prime&lt;br /&gt;|             Modulus Source: mod_ssl 2.0.x/512-bit MODP group with safe prime modulus&lt;br /&gt;|             Modulus Length: 512&lt;br /&gt;|             Generator Length: 8&lt;br /&gt;|             Public Key Length: 512&lt;br /&gt;|     References:&lt;br /&gt;|       &lt;a href=”<a href="https://weakdh.org">https://weakdh.org</a>“&gt;<a href="https://weakdh.org">https://weakdh.org</a>&lt;/a&gt;&lt;br /&gt;|       &lt;a href=”<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</a>“&gt;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</a>&lt;/a&gt;&lt;br /&gt;|       &lt;a href=”<a href="https://www.securityfocus.com/bid/74733">https://www.securityfocus.com/bid/74733</a>&quot;&gt;<a href="https://www.securityfocus.com/bid/74733">https://www.securityfocus.com/bid/74733</a>&lt;/a&gt;&lt;br /&gt;|   &lt;br /&gt;|   Diffie-Hellman Key Exchange Insufficient Group Strength&lt;br /&gt;|     State: VULNERABLE&lt;br /&gt;|       Transport Layer Security (TLS) services that use Diffie-Hellman groups&lt;br /&gt;|       of insufficient strength, especially those using one of a few commonly&lt;br /&gt;|       shared groups, may be susceptible to passive eavesdropping attacks.&lt;br /&gt;|     Check results:&lt;br /&gt;|       WEAK DH GROUP 1&lt;br /&gt;|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA&lt;br /&gt;|             Modulus Type: Safe prime&lt;br /&gt;|             Modulus Source: mod_ssl 2.0.x/1024-bit MODP group with safe prime modulus&lt;br /&gt;|             Modulus Length: 1024&lt;br /&gt;|             Generator Length: 8&lt;br /&gt;|             Public Key Length: 1024&lt;br /&gt;|     References:&lt;br /&gt;|</em>      &lt;a href=&quot;<a href="https://weakdh.org">https://weakdh.org</a>“&gt;<a href="https://weakdh.org">https://weakdh.org</a>&lt;/a&gt;&lt;br /&gt;| ssl-poodle: &lt;br /&gt;|   VULNERABLE:&lt;br /&gt;|   SSL POODLE information leak&lt;br /&gt;|     State: VULNERABLE&lt;br /&gt;|     IDs:  BID:70574  CVE:CVE-2014-3566&lt;br /&gt;|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other&lt;br /&gt;|           products, uses nondeterministic CBC padding, which makes it easier&lt;br /&gt;|           for man-in-the-middle attackers to obtain cleartext data via a&lt;br /&gt;|           padding-oracle attack, aka the “POODLE” issue.&lt;br /&gt;|     Disclosure date: 2014-10-14&lt;br /&gt;|     Check results:&lt;br /&gt;|       TLS_RSA_WITH_3DES_EDE_CBC_SHA&lt;br /&gt;|     References:&lt;br /&gt;|       &lt;a href=”<a href="https://www.securityfocus.com/bid/70574">https://www.securityfocus.com/bid/70574</a>“&gt;<a href="https://www.securityfocus.com/bid/70574">https://www.securityfocus.com/bid/70574</a>&lt;/a&gt;&lt;br /&gt;|       &lt;a href=”<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</a>“&gt;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</a>&lt;/a&gt;&lt;br /&gt;|       &lt;a href=”<a href="https://www.imperialviolet.org/2014/10/14/poodle.html">https://www.imperialviolet.org/2014/10/14/poodle.html</a>&quot;&gt;<a href="https://www.imperialviolet.org/2014/10/14/poodle.html">https://www.imperialviolet.org/2014/10/14/poodle.html</a>&lt;/a&gt;&lt;br /&gt;|</em>      &lt;a href=”<a href="https://www.openssl.org/">https://www.openssl.org/</a><sub>bodo/ssl-poodle.pdf&quot;&gt;<a href="https://www.openssl.org/">https://www.openssl.org/</a></sub>bodo/ssl-poodle.pdf&lt;/a&gt;&lt;br /&gt;|_sslv2-drown: ERROR: Script execution failed (use -d to debug)&lt;br /&gt;1024/tcp open  kdm&lt;br /&gt;&lt;br /&gt;Host script results:&lt;br /&gt;|<em>samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]&lt;br /&gt;| smb-vuln-cve2009-3103: &lt;br /&gt;|   VULNERABLE:&lt;br /&gt;|   SMBv2 exploit (CVE-2009-3103, Microsoft Security Advisory 975497)&lt;br /&gt;|     State: VULNERABLE&lt;br /&gt;|     IDs:  CVE:CVE-2009-3103&lt;br /&gt;|           Array index error in the SMBv2 protocol implementation in srv2.sys in Microsoft Windows Vista Gold, SP1, and SP2,&lt;br /&gt;|           Windows Server 2008 Gold and SP2, and Windows 7 RC allows remote attackers to execute arbitrary code or cause a&lt;br /&gt;|           denial of service (system crash) via an &amp; (ampersand) character in a Process ID High header field in a NEGOTIATE&lt;br /&gt;|           PROTOCOL REQUEST packet, which triggers an attempted dereference of an out-of-bounds memory location,&lt;br /&gt;|           aka “SMBv2 Negotiation Vulnerability.”&lt;br /&gt;|           &lt;br /&gt;|     Disclosure date: 2009-09-08&lt;br /&gt;|     References:&lt;br /&gt;|       &lt;a href=&quot;<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a>&quot;&gt;<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a>&lt;/a&gt;&lt;br /&gt;|</em>      &lt;a href=&quot;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a>“&gt;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3103</a>&lt;/a&gt;&lt;br /&gt;|_smb-vuln-ms10-054: false&lt;br /&gt;|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: ERROR: Server returned less data than it was supposed to (one or more fields are missing); aborting [14]&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;is it possible to create a script which only runs -A against open ports from the -p- scan?&lt;br /&gt;our job is to scan for open ports, then try to exploit them.&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Enumerating HTTP/S&lt;/h1&gt;&lt;br/&gt;## Enumerating HTTP and HTTPS&lt;br /&gt;### think about it from the POV of an attacker&lt;br /&gt;develop this methodology over time&lt;br /&gt;when you see a website, what are the basics you’re looking for?&lt;br /&gt;service enumeration&lt;br /&gt;back end directories&lt;br /&gt;source code&lt;br /&gt;vulnerability scanning&lt;br /&gt;any sort of information that can be divulged&lt;br /&gt;&lt;br /&gt;### Go to the website (on all ports available (80, 8080, 443, etc))&lt;br /&gt;If you see a default web page, this is an automatic FINDING&lt;br /&gt;Always write this up in the report as an information disclosure&lt;br /&gt;Tells you about the architecture and hygiene&lt;br /&gt;404 is an information disclosure as well if lists version, hostname, port&lt;br /&gt;&lt;br /&gt;Click around in the web page a little&lt;br /&gt;&lt;br /&gt;View source&lt;br /&gt;&lt;br /&gt;Perform a vulnerability scan&lt;br /&gt;&lt;br /&gt;Dig through the results for anything of value, enumerate and note&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;## Nikto&lt;br /&gt;Be wary to not get yourself blocked by a WAF, like an IPS would block nmap -sS scans&lt;br /&gt;nikto -h &lt;a href=”<a href="http://IP">http://IP</a>“&gt;<a href="http://IP">http://IP</a>&lt;/a&gt;&lt;br /&gt;anything that lists as outdated is a finding to notate on report&lt;br /&gt;any directories found are findings, but dirbust later for full lists&lt;br /&gt;look for juicy stuff (remote buffer overflow to shell) for separate exploitation phase notes&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;## Dirbuster&lt;br /&gt;dirbuster&amp;&lt;br /&gt;enter <a href="http://ip">http://ip</a>:port&lt;br /&gt;browse to /usr/share/wordlists/dirbuster/(pick one that makes sense)&lt;br /&gt;alternately, use /usr/share/seclists/&lt;br /&gt;add file extensions (php, asp, aspx) that make sense for whatever the server runs&lt;br /&gt;add file extensions of txt, zip, rar, pdf, docx, etc as well&lt;br /&gt;it will find stuff for you to investigate, of course&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;## Burpsuite intro&lt;br /&gt;start foxyproxy&lt;br /&gt;start burp&lt;br /&gt;intercept one request&lt;br /&gt;send to Repeater&lt;br /&gt;edit the sent requests directly through Repeater and see response in real time (GET/POST etc)&lt;br /&gt;go to target&lt;br /&gt;set scope to each target and port&lt;br /&gt;check server headers for information disclosure of webserver&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;## Dirb&lt;br /&gt;also exists&lt;br /&gt;&lt;br /&gt;## Gobuster&lt;br /&gt;my fav so far&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Enumerating SMB&lt;/h1&gt;&lt;br/&gt;## Enumerating SMB&lt;br /&gt;port 139&lt;br /&gt;SMB = file share&lt;br /&gt;Like those C:\Scans folders&lt;br /&gt;nmap -A will run enumeration scripts against SMB by default&lt;br /&gt;Try to connect to the machine to see what’s in it&lt;br /&gt;spin up Metasploit with $msfconsole&lt;br /&gt;&gt;search smb&lt;br /&gt;The auxiliary/scanner||fuzzer modules are for enumeration&lt;br /&gt;&gt;use auxiliary/scanner/smb/smb_version&lt;br /&gt;&gt;show options&lt;br /&gt;&gt;set &lt;option&gt; for each &lt;option&gt;&lt;br /&gt;(Yes we all know this already, but I have to take notes)&lt;br /&gt;there’s &gt;show advanced options?&lt;br /&gt;&gt;run&lt;br /&gt;Paste the output into your notes&lt;br /&gt;&lt;br /&gt;My enum4linux and/or smbclient are not working. I am receiving  “Protocol negotiation failed: NT_STATUS_IO_TIMEOUT”. How do I resolve?&lt;br /&gt;&lt;strong&gt;Resolution&lt;/strong&gt;:&lt;br /&gt;On Kali, edit /etc/samba/smb.conf&lt;br /&gt;Add the following under global:&lt;br /&gt;client min protocol = CORE&lt;br /&gt;client max protocol = SMB3&lt;br /&gt;&lt;br /&gt;### smbclient&lt;br /&gt;Smbclient to connect via anonymous shares if available&lt;br /&gt;Because you never know what you’ll find until you actually look&lt;br /&gt;#smbclient -L \\&lt;ip&gt;\&lt;br /&gt;-L lists shares&lt;br /&gt;press enter at password prompt&lt;br /&gt;then look at the shares listed&lt;br /&gt;#smbclient \\&lt;ip&gt;\&lt;the shares listed$&gt;&lt;br /&gt;So for SMB sometimes you get lucky, sometimes you don’t&lt;br /&gt;But SMB is always important for AD stuff later&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Enumerating SSH&lt;/h1&gt;&lt;br/&gt;## Enumerating SSH&lt;br /&gt;Copy and paste your nmap scan ssh info into exploit-db&lt;br /&gt;Basically as soon as you test a single ssh login, you’re actively in exploit phase&lt;br /&gt;&lt;br /&gt;Problem: &lt;br /&gt;Unable to negotiate… No matching key exchange method found.  Their offer: &lt;keyexchoffer&gt;&lt;br /&gt;Solution: &lt;br /&gt;#ssh &lt;ip&gt;  -oKexAlgorithms=+&lt;keyexchoffer&gt;&lt;br /&gt;Unable to negotiate…No matching cipher found.  Their offer: &lt;ciper&gt;&lt;br /&gt;#ssh &lt;ip&gt; -oKexAlgorithm=+&lt;keyexchoffer&gt; -c &lt;cipher&gt;&lt;br /&gt;Now you can connect&lt;br /&gt;I’ve run into this on htb often.&lt;br /&gt;&lt;br /&gt;That’s it for ssh.  &lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Researching Vulnerabilities&lt;/h1&gt;&lt;br/&gt;## Researching Vulnerabilities&lt;br /&gt;Identifying and researching potential vulnerabilities&lt;br /&gt;&lt;br /&gt;Take all the scan output results you’ve pasted into notes&lt;br /&gt;Target the low hanging fruit:&lt;br /&gt;port 80&lt;br /&gt;port 443&lt;br /&gt;port 139&lt;br /&gt;other web ports&lt;br /&gt;port 22&lt;br /&gt;&lt;br /&gt;If you see potential RCE anything, that’s the juciest fruit to start with.&lt;br /&gt;But be thorough.  &lt;br /&gt;Look up vulnerabilities, take notes, move on.  &lt;br /&gt;&lt;br /&gt;Notes vuln syntax:&lt;br /&gt;port# - “Potentially vulnerable to &lt;vuln name&gt;” (links)&lt;br /&gt;port# - “Potentially vulnerable to &lt;vuln name&gt;” (links)&lt;br /&gt;port# - “Potentially vulnerable to &lt;vuln name&gt;” (links)&lt;br /&gt;&lt;br /&gt;Check this stuff against CVE listings and add listings as subnotes.  &lt;br /&gt;&lt;br /&gt;## Searchsploit&lt;br /&gt;#searchsploit &lt;protocol or service&gt;&lt;br /&gt;You can be too specific with searchsploit&lt;br /&gt;#searchsploit Samba 2.2.3&lt;br /&gt;= No results&lt;br /&gt;#searchsploit Samba 2&lt;br /&gt;= Lots of results&lt;br /&gt;&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Notes So Far&lt;/h1&gt;&lt;br/&gt;–Site&lt;br /&gt;----hostname&lt;br /&gt;------enumeration&lt;br /&gt;--------nmap&lt;br /&gt;------------port/result&lt;br /&gt;------------port/result&lt;br /&gt;--------nikto&lt;br /&gt;------------page/result&lt;br /&gt;------exploitation&lt;br /&gt;--------blah blah&lt;br /&gt;------findings&lt;br /&gt;------------one page per finding plus screenshots&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;MassScan&lt;/h1&gt;&lt;br/&gt;## Scanning with Masscan&lt;br /&gt;Masscan was built to scan the entire internet really fast&lt;br /&gt;It’s a port scanner, built into kali2.0&lt;br /&gt;This is an Internet-scale port scanner. It can scan the entire Internet in under 5 minutes, transmitting 10 million packets per second, from a single machine.&lt;br /&gt;Its usage (parameters, output) is similar to &lt;code&gt;nmap&lt;/code&gt;, the most famous port scanner. When in doubt, try one of those features – features that support widespread scanning of many machines are supported, while in-depth scanning of single machines aren’t.&lt;br /&gt;NOTE: masscan uses its own &lt;strong&gt;ad hoc TCP/IP stack&lt;/strong&gt;. Anything other than simple port scans may cause conflict with the local TCP/IP stack. &lt;br /&gt;&lt;br /&gt;#masscan -p1-65535 192.168.1.50&lt;br /&gt;&lt;br /&gt;By default it will force -sS -Pn options&lt;br /&gt;–rate 1000 speeds it up considerably&lt;br /&gt;&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Metasploit&lt;/h1&gt;&lt;br/&gt;## Scanning with Metasploit&lt;br /&gt;&lt;br /&gt;&gt;search portscan&lt;br /&gt;You’re looking for the syn scanner&lt;br /&gt;show options and fill in requirements&lt;br /&gt;this is kinda slow, doesn’t give you that much detail&lt;br /&gt;You can multi-thread it&lt;br /&gt;it’s just another auxiliary module you should know you can use&lt;br /&gt;&lt;/div&gt;&lt;div class=‘page’&gt;&lt;h1 class=‘title level-2’&gt;Nessus&lt;/h1&gt;&lt;br/&gt;## Scanning with Nessus&lt;br /&gt;Typically you will start a Nessus scan, then move to enumeration, then return to the Nessus scan once it’s complete&lt;br /&gt;&lt;br /&gt;### Download and Install Nessus&lt;br /&gt;Download Nessus x64  &lt;br /&gt;Install it  &lt;br /&gt;Navigate to it (<a href="http://localhost:8834">http://localhost:8834</a>)&lt;br /&gt;It will compile plugins, which will take some time&lt;br /&gt;Install whichever license (Essentials)&lt;br /&gt;Get activation code, copy/paste&lt;br /&gt;Need a new activation code with each new installation if Essentials&lt;br /&gt;Let it finish installing&lt;br /&gt;Log in&lt;br /&gt;&lt;br /&gt;### Run a Scan with Nessus&lt;br /&gt;Scan &gt; Templates &gt; Basic Scan&lt;br /&gt;Name the scan job&lt;br /&gt;Enter targets to scan against&lt;br /&gt;Do port scan of all ports via options&lt;br /&gt;Set scan type&lt;br /&gt;Go ahead and look through the options&lt;br /&gt;Start scan&lt;br /&gt;&lt;br /&gt;### Review Nessus Scan Results&lt;br /&gt;View results&lt;br /&gt;Click the Vulnerabilities tab&lt;br /&gt;Click Settings cog, disable Grouping&lt;br /&gt;View installed version, and recommended version to patch&lt;br /&gt;Sift through the results and report on what’s important and potential for exploitation&lt;br /&gt;Download nessus file&lt;br /&gt;There are tools to turn a .nessus file into an excel file&lt;br /&gt;&lt;br /&gt;### Converting .nessus File&lt;br /&gt;Into CSV&lt;br /&gt;&lt;a href=”<a href="https://github.com/levyjm/NessusConverter">https://github.com/levyjm/NessusConverter</a>“&gt;<a href="https://github.com/levyjm/NessusConverter">https://github.com/levyjm/NessusConverter</a>&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;Into Excel 2003&lt;br /&gt;&lt;a href=”<a href="https://seclists.org/pen-test/2006/Apr/82">https://seclists.org/pen-test/2006/Apr/82</a>&quot;&gt;<a href="https://seclists.org/pen-test/2006/Apr/82">https://seclists.org/pen-test/2006/Apr/82</a>&lt;/a&gt;&lt;br /&gt;You can use the XML version of the Nessus report and just directly import it&lt;br /&gt;into Excel (at least in 2003).&lt;br /&gt;In Excel:&lt;br /&gt; - Drop down the “Data” menu on the toolbar&lt;br /&gt; - Point to “XML” then click “Import”&lt;br /&gt; - Click “Ok” a couple times; all the results are imported nicely into Excel via SOME method, there are tools out there that do this&lt;br /&gt; ## Ungroup the scan results&lt;br /&gt; -Click Scans&lt;br /&gt; -Click Vulnerabilities tab&lt;br /&gt; -Click Settings gear&lt;br /&gt; -Click Disable Groups&lt;br /&gt; &lt;br /&gt; Specifically tell the Client to review the Nessus results (excel format it)&lt;br /&gt; Always verify, never trust your vulnerability scanner&lt;br /&gt; Don’t provide a screenshot of a nessus finding, provide a screenshot of the proof.  &lt;br /&gt; &lt;br /&gt; As a pentester, own two programs:&lt;br /&gt; 1. Nessus&lt;br /&gt; 2. Burpsuite&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</p>
